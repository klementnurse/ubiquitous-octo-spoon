{"ast":null,"code":"var _jsxFileName = \"/Users/matthew/Desktop/optizmo/webapp/app/src/components/confirmation/Confirmation.tsx\",\n    _this = this,\n    _s = $RefreshSig$();\n\nimport qs from 'qs';\nimport { Redirect, useLocation } from 'react-router-dom';\nimport { formatInternationalPhone } from '../../utils';\nimport Advertisement from './Advertisement';\nimport Spinner from '../common/Spinner';\nimport { useAppContext } from '../../contexts/AppContext';\nimport CreativeFeedbackCollection from './CreativeFeedbackCollection';\n/**\n * Opt-out submission state is passed to the Confirmation screen via location.state.\n */\n\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\n/**\n * Display an opt-out confirmation message, or potentially redirect to advertising.\n * This screen doesn't try to load any data, instead it depends on state passed\n * from <Landing />. Directly accessing the route will result in \"not found\" state.\n */\nvar Confirmation = function Confirmation() {\n  _s();\n\n  var _pageData$confirmatio, _pageData$confirmatio2;\n\n  var _useLocation = useLocation(),\n      state = _useLocation.state;\n\n  var _useAppContext = useAppContext(),\n      campaignMailer = _useAppContext.campaignMailer,\n      pageData = _useAppContext.pageData;\n\n  if (!(state === null || state === void 0 ? void 0 : state.email) && !(state === null || state === void 0 ? void 0 : state.sms)) {\n    return /*#__PURE__*/_jsxDEV(Redirect, {\n      to: \"/notfound\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 47,\n      columnNumber: 12\n    }, _this);\n  }\n\n  var email = state.email,\n      sms = state.sms,\n      showAd = state.showAd,\n      collectFeedback = state.collectFeedback;\n\n  if (showAd && (campaignMailer === null || campaignMailer === void 0 ? void 0 : campaignMailer.optoutAdRedirectUrl)) {\n    var paramsObject = {\n      utm_source: 'live',\n      utm_medium: 'traffic',\n      utm_campaign: 'one',\n      sc: campaignMailer === null || campaignMailer === void 0 ? void 0 : campaignMailer.sourceClientId\n    }; // Only append the targetClientId param if its a submailer access key\n\n    if (campaignMailer === null || campaignMailer === void 0 ? void 0 : campaignMailer.targetClientId) {\n      paramsObject.tc = campaignMailer === null || campaignMailer === void 0 ? void 0 : campaignMailer.targetClientId;\n    }\n\n    var params = qs.stringify(paramsObject);\n    var redirectUrl = \"\".concat(campaignMailer === null || campaignMailer === void 0 ? void 0 : campaignMailer.optoutAdRedirectUrl).concat((campaignMailer === null || campaignMailer === void 0 ? void 0 : campaignMailer.optoutAdRedirectUrl.match(/\\?/)) ? '&' : '?').concat(params);\n    window.location.replace(redirectUrl);\n    return /*#__PURE__*/_jsxDEV(Spinner, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 12\n    }, _this);\n  }\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      textAlign: 'center'\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: pageData === null || pageData === void 0 ? void 0 : (_pageData$confirmatio = pageData.confirmation) === null || _pageData$confirmatio === void 0 ? void 0 : _pageData$confirmatio.title\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 7\n    }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        paddingTop: 16\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 7\n    }, _this), /*#__PURE__*/_jsxDEV(\"strong\", {\n      children: \"Successfully unsubscribed:\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 7\n    }, _this), /*#__PURE__*/_jsxDEV(\"p\", {\n      children: [email ? email : null, sms ? formatInternationalPhone(sms) : null]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 7\n    }, _this), (pageData === null || pageData === void 0 ? void 0 : (_pageData$confirmatio2 = pageData.confirmation) === null || _pageData$confirmatio2 === void 0 ? void 0 : _pageData$confirmatio2.content) ? /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"text-muted\",\n      dangerouslySetInnerHTML: {\n        __html: pageData.confirmation.content\n      },\n      style: {\n        paddingTop: 16\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 9\n    }, _this) : null, collectFeedback ? /*#__PURE__*/_jsxDEV(\"div\", {\n      \"data-testid\": \"confirmation__creative-feedback-collection\",\n      children: /*#__PURE__*/_jsxDEV(CreativeFeedbackCollection, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 112,\n        columnNumber: 11\n      }, _this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 9\n    }, _this) : undefined, showAd ? /*#__PURE__*/_jsxDEV(\"div\", {\n      \"data-testid\": \"confirmation__advertisement\",\n      children: /*#__PURE__*/_jsxDEV(Advertisement, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 118,\n        columnNumber: 11\n      }, _this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 9\n    }, _this) : null]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 89,\n    columnNumber: 5\n  }, _this);\n};\n\n_s(Confirmation, \"B/2vLUQL3drUAxS6g7V7nroNZEQ=\", false, function () {\n  return [useLocation, useAppContext];\n});\n\n_c = Confirmation;\nexport default Confirmation;\n\nvar _c;\n\n$RefreshReg$(_c, \"Confirmation\");","map":{"version":3,"sources":["/Users/matthew/Desktop/optizmo/webapp/app/src/components/confirmation/Confirmation.tsx"],"names":["qs","Redirect","useLocation","formatInternationalPhone","Advertisement","Spinner","useAppContext","CreativeFeedbackCollection","Confirmation","state","campaignMailer","pageData","email","sms","showAd","collectFeedback","optoutAdRedirectUrl","paramsObject","utm_source","utm_medium","utm_campaign","sc","sourceClientId","targetClientId","tc","params","stringify","redirectUrl","match","window","location","replace","textAlign","confirmation","title","paddingTop","content","__html","undefined"],"mappings":"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","sourcesContent":["import qs from 'qs'\nimport { Redirect, useLocation } from 'react-router-dom'\nimport { formatInternationalPhone } from '../../utils'\nimport Advertisement from './Advertisement'\nimport Spinner from '../common/Spinner'\nimport { useAppContext } from '../../contexts/AppContext'\nimport CreativeFeedbackCollection from './CreativeFeedbackCollection'\n\n/**\n * Opt-out submission state is passed to the Confirmation screen via location.state.\n */\ninterface LocationState {\n  /**\n   * Opt-out email address. Either this or @see sms will be present.\n   */\n  email?: string\n\n  /**\n   * Opt-out photo number. Either this or @see email will be present.\n   */\n  sms?: string\n\n  /**\n   * Show an inline advertiser, or redirect to an external ad site if the campaignMailer\n   * is configured to do so.\n   */\n  showAd?: boolean\n\n  /**\n   * If the opt-out submission process determined the opt-out email address should\n   * collect creative feedback, a form to do so is shown.\n   * Does not apply for SMS opt-outs.\n   */\n  collectFeedback?: boolean\n}\n\n/**\n * Display an opt-out confirmation message, or potentially redirect to advertising.\n * This screen doesn't try to load any data, instead it depends on state passed\n * from <Landing />. Directly accessing the route will result in \"not found\" state.\n */\nconst Confirmation = () => {\n  const { state } = useLocation<LocationState>()\n  const { campaignMailer, pageData } = useAppContext()\n\n  if (!state?.email && !state?.sms) {\n    return <Redirect to='/notfound' />\n  }\n\n  const { email, sms, showAd, collectFeedback } = state\n\n  if (showAd && campaignMailer?.optoutAdRedirectUrl) {\n    const paramsObject: {\n      utm_source: string\n      utm_medium: string\n      utm_campaign: string\n\n      /**\n       * Source client id - slightly obfuscated.\n       */\n      sc: number\n\n      /**\n       * Target client id - slightly obfuscated.\n       */\n      tc?: number\n    } = {\n      utm_source: 'live',\n      utm_medium: 'traffic',\n      utm_campaign: 'one',\n      sc: campaignMailer?.sourceClientId\n    }\n\n    // Only append the targetClientId param if its a submailer access key\n    if (campaignMailer?.targetClientId) {\n      paramsObject.tc = campaignMailer?.targetClientId\n    }\n\n    const params = qs.stringify(paramsObject)\n    const redirectUrl = `${campaignMailer?.optoutAdRedirectUrl}${\n      campaignMailer?.optoutAdRedirectUrl.match(/\\?/) ? '&' : '?'\n    }${params}`\n    window.location.replace(redirectUrl)\n\n    return <Spinner />\n  }\n\n  return (\n    <div style={{ textAlign: 'center' }}>\n      <h2>{pageData?.confirmation?.title}</h2>\n\n      <div style={{ paddingTop: 16 }} />\n\n      <strong>Successfully unsubscribed:</strong>\n      <p>\n        {email ? email : null}\n        {sms ? formatInternationalPhone(sms) : null}\n      </p>\n\n      {pageData?.confirmation?.content ? (\n        <div\n          className='text-muted'\n          dangerouslySetInnerHTML={{\n            __html: pageData.confirmation.content\n          }}\n          style={{ paddingTop: 16 }}\n        />\n      ) : null}\n\n      {collectFeedback ? (\n        <div data-testid='confirmation__creative-feedback-collection'>\n          <CreativeFeedbackCollection />\n        </div>\n      ) : undefined}\n\n      {showAd ? (\n        <div data-testid='confirmation__advertisement'>\n          <Advertisement />\n        </div>\n      ) : null}\n    </div>\n  )\n}\n\nexport default Confirmation\n"]},"metadata":{},"sourceType":"module"}