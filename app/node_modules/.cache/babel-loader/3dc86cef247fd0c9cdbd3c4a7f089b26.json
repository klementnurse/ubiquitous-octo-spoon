{"ast":null,"code":"import _regeneratorRuntime from \"/Users/matthew/Desktop/optizmo/webapp/app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/matthew/Desktop/optizmo/webapp/app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"/Users/matthew/Desktop/optizmo/webapp/app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _jsxFileName = \"/Users/matthew/Desktop/optizmo/webapp/app/src/components/confirmation/CreativeFeedbackCollection.tsx\",\n    _this = this,\n    _s = $RefreshSig$();\n\nimport { useEffect, useState } from 'react';\nimport { InputGroup, InputGroupText, Input } from 'reactstrap';\nimport { useAppContext } from '../../contexts/AppContext';\nimport { simpleToken } from '../../services/legacy';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport var generateFeedbackForwardEmail = function generateFeedbackForwardEmail(token, legacyKey) {\n  return \"clb_\".concat(token, \"_\").concat(legacyKey, \"@optout-feedback.com\");\n};\n/**\n * Provide the opt-out user with a unique email address to forward the received\n * marketing email (creative) for us to analyse.\n */\n\nvar CreativeFeedbackCollection = function CreativeFeedbackCollection() {\n  _s();\n\n  var _useState = useState(),\n      _useState2 = _slicedToArray(_useState, 2),\n      targetEmail = _useState2[0],\n      setTargetEmail = _useState2[1];\n\n  var _useAppContext = useAppContext(),\n      campaignMailer = _useAppContext.campaignMailer;\n\n  useEffect(function () {\n    if (!campaignMailer) {\n      return;\n    }\n\n    var legacyKey = campaignMailer.legacyKey;\n\n    var fetchData = /*#__PURE__*/function () {\n      var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        var token, email;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.prev = 0;\n                _context.next = 3;\n                return simpleToken();\n\n              case 3:\n                token = _context.sent;\n                email = generateFeedbackForwardEmail(token, legacyKey);\n                setTargetEmail(email);\n                _context.next = 11;\n                break;\n\n              case 8:\n                _context.prev = 8;\n                _context.t0 = _context[\"catch\"](0);\n                console.error(_context.t0);\n\n              case 11:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, null, [[0, 8]]);\n      }));\n\n      return function fetchData() {\n        return _ref.apply(this, arguments);\n      };\n    }();\n\n    fetchData();\n  }, [campaignMailer]);\n\n  if (!targetEmail) {\n    return null;\n  }\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      textAlign: 'left'\n    },\n    \"data-testid\": \"creative-feedback-collection\",\n    children: [/*#__PURE__*/_jsxDEV(\"hr\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 50,\n      columnNumber: 7\n    }, _this), /*#__PURE__*/_jsxDEV(\"h5\", {\n      children: [\"Please Forward The Email : \", /*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"text-muted\",\n        children: \"Optional\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 52,\n        columnNumber: 36\n      }, _this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 51,\n      columnNumber: 7\n    }, _this), /*#__PURE__*/_jsxDEV(\"p\", {\n      children: \"Sometimes we use companies to send emails on our behalf. Forwarding the email helps us determine if the correct email was sent to you and if there were any issues in the sending process.\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 54,\n      columnNumber: 7\n    }, _this), /*#__PURE__*/_jsxDEV(InputGroup, {\n      children: [/*#__PURE__*/_jsxDEV(InputGroupText, {\n        children: \"Forward To: \"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 61,\n        columnNumber: 9\n      }, _this), /*#__PURE__*/_jsxDEV(Input, {\n        readOnly: true,\n        value: targetEmail,\n        \"data-testid\": \"creative-feedback-collection__forward-email\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 62,\n        columnNumber: 9\n      }, _this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 60,\n      columnNumber: 7\n    }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        paddingTop: 8\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 7\n    }, _this), /*#__PURE__*/_jsxDEV(\"i\", {\n      className: \"text-muted\",\n      children: \"Just note that this is not a required process for unsubscribing, you have already been unsubscribed. Also this email will only work for the next 48 hours, so please forward the email asap.\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 7\n    }, _this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 44,\n    columnNumber: 5\n  }, _this);\n};\n\n_s(CreativeFeedbackCollection, \"fIkNb8Or5ajfAbJ4ehTSq5YU/pA=\", false, function () {\n  return [useAppContext];\n});\n\n_c = CreativeFeedbackCollection;\nexport default CreativeFeedbackCollection;\n\nvar _c;\n\n$RefreshReg$(_c, \"CreativeFeedbackCollection\");","map":{"version":3,"sources":["/Users/matthew/Desktop/optizmo/webapp/app/src/components/confirmation/CreativeFeedbackCollection.tsx"],"names":["useEffect","useState","InputGroup","InputGroupText","Input","useAppContext","simpleToken","generateFeedbackForwardEmail","token","legacyKey","CreativeFeedbackCollection","targetEmail","setTargetEmail","campaignMailer","fetchData","email","console","error","textAlign","paddingTop"],"mappings":";;;;;;;;AAAA,SAASA,SAAT,EAAoBC,QAApB,QAAoC,OAApC;AACA,SAASC,UAAT,EAAqBC,cAArB,EAAqCC,KAArC,QAAkD,YAAlD;AACA,SAASC,aAAT,QAA8B,2BAA9B;AACA,SAASC,WAAT,QAA4B,uBAA5B;;AAEA,OAAO,IAAMC,4BAA4B,GAAG,SAA/BA,4BAA+B,CAC1CC,KAD0C,EAE1CC,SAF0C;AAAA,uBAGhCD,KAHgC,cAGvBC,SAHuB;AAAA,CAArC;AAKP;AACA;AACA;AACA;;AACA,IAAMC,0BAA0B,GAAG,SAA7BA,0BAA6B,GAAM;AAAA;;AACvC,kBAAsCT,QAAQ,EAA9C;AAAA;AAAA,MAAOU,WAAP;AAAA,MAAoBC,cAApB;;AACA,uBAA2BP,aAAa,EAAxC;AAAA,MAAQQ,cAAR,kBAAQA,cAAR;;AAEAb,EAAAA,SAAS,CAAC,YAAM;AACd,QAAI,CAACa,cAAL,EAAqB;AACnB;AACD;;AAED,QAAQJ,SAAR,GAAsBI,cAAtB,CAAQJ,SAAR;;AAEA,QAAMK,SAAS;AAAA,0EAAG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBAEMR,WAAW,EAFjB;;AAAA;AAERE,gBAAAA,KAFQ;AAGRO,gBAAAA,KAHQ,GAGAR,4BAA4B,CAACC,KAAD,EAAQC,SAAR,CAH5B;AAIdG,gBAAAA,cAAc,CAACG,KAAD,CAAd;AAJc;AAAA;;AAAA;AAAA;AAAA;AAMdC,gBAAAA,OAAO,CAACC,KAAR;;AANc;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAH;;AAAA,sBAATH,SAAS;AAAA;AAAA;AAAA,OAAf;;AAUAA,IAAAA,SAAS;AACV,GAlBQ,EAkBN,CAACD,cAAD,CAlBM,CAAT;;AAoBA,MAAI,CAACF,WAAL,EAAkB;AAChB,WAAO,IAAP;AACD;;AAED,sBACE;AACE,IAAA,KAAK,EAAE;AACLO,MAAAA,SAAS,EAAE;AADN,KADT;AAIE,mBAAY,8BAJd;AAAA,4BAME;AAAA;AAAA;AAAA;AAAA,aANF,eAOE;AAAA,6DAC6B;AAAM,QAAA,SAAS,EAAC,YAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,eAD7B;AAAA;AAAA;AAAA;AAAA;AAAA,aAPF,eAUE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aAVF,eAgBE,QAAC,UAAD;AAAA,8BACE,QAAC,cAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,eADF,eAEE,QAAC,KAAD;AACE,QAAA,QAAQ,EAAE,IADZ;AAEE,QAAA,KAAK,EAAEP,WAFT;AAGE,uBAAY;AAHd;AAAA;AAAA;AAAA;AAAA,eAFF;AAAA;AAAA;AAAA;AAAA;AAAA,aAhBF,eAyBE;AAAK,MAAA,KAAK,EAAE;AAAEQ,QAAAA,UAAU,EAAE;AAAd;AAAZ;AAAA;AAAA;AAAA;AAAA,aAzBF,eA0BE;AAAG,MAAA,SAAS,EAAC,YAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aA1BF;AAAA;AAAA;AAAA;AAAA;AAAA,WADF;AAkCD,CA9DD;;GAAMT,0B;UAEuBL,a;;;KAFvBK,0B;AAgEN,eAAeA,0BAAf","sourcesContent":["import { useEffect, useState } from 'react'\nimport { InputGroup, InputGroupText, Input } from 'reactstrap'\nimport { useAppContext } from '../../contexts/AppContext'\nimport { simpleToken } from '../../services/legacy'\n\nexport const generateFeedbackForwardEmail = (\n  token: string,\n  legacyKey: string\n) => `clb_${token}_${legacyKey}@optout-feedback.com`\n\n/**\n * Provide the opt-out user with a unique email address to forward the received\n * marketing email (creative) for us to analyse.\n */\nconst CreativeFeedbackCollection = () => {\n  const [targetEmail, setTargetEmail] = useState<string | undefined>()\n  const { campaignMailer } = useAppContext()\n\n  useEffect(() => {\n    if (!campaignMailer) {\n      return\n    }\n\n    const { legacyKey } = campaignMailer\n\n    const fetchData = async () => {\n      try {\n        const token = await simpleToken()\n        const email = generateFeedbackForwardEmail(token, legacyKey)\n        setTargetEmail(email)\n      } catch (err) {\n        console.error(err)\n      }\n    }\n\n    fetchData()\n  }, [campaignMailer])\n\n  if (!targetEmail) {\n    return null\n  }\n\n  return (\n    <div\n      style={{\n        textAlign: 'left'\n      }}\n      data-testid='creative-feedback-collection'\n    >\n      <hr />\n      <h5>\n        Please Forward The Email : <span className='text-muted'>Optional</span>\n      </h5>\n      <p>\n        Sometimes we use companies to send emails on our behalf. Forwarding the\n        email helps us determine if the correct email was sent to you and if\n        there were any issues in the sending process.\n      </p>\n\n      <InputGroup>\n        <InputGroupText>Forward To: </InputGroupText>\n        <Input\n          readOnly={true}\n          value={targetEmail}\n          data-testid='creative-feedback-collection__forward-email'\n        />\n      </InputGroup>\n\n      <div style={{ paddingTop: 8 }} />\n      <i className='text-muted'>\n        Just note that this is not a required process for unsubscribing, you\n        have already been unsubscribed. Also this email will only work for the\n        next 48 hours, so please forward the email asap.\n      </i>\n    </div>\n  )\n}\n\nexport default CreativeFeedbackCollection\n"]},"metadata":{},"sourceType":"module"}